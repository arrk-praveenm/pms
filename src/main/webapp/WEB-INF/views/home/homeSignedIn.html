<!DOCTYPE html>
<!--mv cmbncmvbn-->
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
<title th:text="#{view.index.title}">Welcome!</title>
<meta
	content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no'
	name='viewport' />
<!-- <link href="../../../resources/css/bootstrap.min.css" rel="stylesheet" media="screen" th:href="@{/resources/css/bootstrap.min.css}"/>
    <link href="../../../resources/css/core.css" rel="stylesheet" media="screen" th:href="@{/resources/css/core.css}" />
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script src="../../../resources/js/bootstrap.min.js" th:src="@{/resources/js/bootstrap.min.js}"></script> -->
<!-- Bootstrap 3.3.4 -->
<link href="../../../resources/css/bootstrap.min.css" rel="stylesheet"
	th:href="@{/resources/css/bootstrap.min.css}" />
<!-- Font Awesome Icons -->
<link href="../../../resources/css/font-awesome.min.css"
	rel="stylesheet" th:href="@{/resources/css/font-awesome.min.css}" />
<!-- Ionicons -->
<link href="../../../resources/css/ionicons.min.css" rel="stylesheet"
	th:href="@{/resources/css/ionicons.min.css}" />
<!-- Theme style -->
<link href="../../../resources/css/pmsadmin.min.css" rel="stylesheet"
	th:href="@{/resources/css/pmsadmin.min.css}" />
<!-- Skin style -->
<link href="../../../resources/css/skins/_all-skins.min.css"
	rel="stylesheet" th:href="@{/resources/css/skins/_all-skins.min.css}" />
<!-- Bootstrap datepicker CSS -->
<link href="../../../resources/css/datepicker.css" rel="stylesheet"
	th:href="@{/resources/css/datepicker.css}" />
<!-- iCheck CSS -->
<link href="../../../resources/plugins/iCheck/square/blue.css"
	rel="stylesheet" th:href="@{/resources/plugins/iCheck/square/blue.css}" />
<!-- CSS for datatables -->
<link
	href="../../../resources/plugins/datatables/dataTables.bootstrap.css"
	rel="stylesheet"
	th:href="@{/resources/plugins/datatables/dataTables.bootstrap.css}" />
<!-- CSS for impromptu modal window -->
<link href="../../../resources/css/jquery-impromptu.min.css"
	rel="stylesheet" th:href="@{/resources/css/jquery-impromptu.min.css}" />

<!-- Notification CSS -->
<link href="../../../resources/css/jquery_notification.css"
	rel="stylesheet" th:href="@{/resources/css/jquery_notification.css}" />

<!-- Custom CSS -->
<link href="../../../resources/css/pms.css" rel="stylesheet"
	th:href="@{/resources/css/pms.css}" />

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
        <script src="../../../resources/js/html5shiv.min.js"></script>
        <script src="../../../resources/js/respond.min.js"></script>
    <![endif]-->


<!-- REQUIRED JS SCRIPTS -->

<!-- jQuery 2.1.4 -->
<script src="../../../resources/plugins/jQuery/jQuery-2.1.4.min.js"
	th:src="@{/resources/plugins/jQuery/jQuery-2.1.4.min.js}"></script>
<!-- Bootstrap 3.3.2 JS -->
<script src="../../../resources/js/bootstrap.min.js"
	th:src="@{/resources/js/bootstrap.min.js}"></script>
<!-- AdminLTE App -->
<script src="../../../resources/js/app.min.js"
	th:src="@{/resources/js/app.min.js}"></script>
<!-- date-range-picker -->
<script src="../../../resources/js/moment.min.js"
	th:src="@{/resources/js/moment.min.js}"></script>
<script
	src="../../../resources/plugins/daterangepicker/daterangepicker.js"
	th:src="@{/resources/plugins/daterangepicker/daterangepicker.js}"></script>

<script
	src="../../../resources/plugins/jQueryUI/jquery-ui.min.js"
	th:src="@{/resources/plugins/jQueryUI/jquery-ui.min.js}"></script>
<!-- Bootstrap datapicker -->
<script src="../../../resources/js/bootstrap-datepicker.js"
	th:src="@{/resources/js/bootstrap-datepicker.js}"></script>
<!-- DATA TABES SCRIPT -->
<script
	src="../../../resources/plugins/datatables/jquery.dataTables.min.js"
	th:src="@{/resources/plugins/datatables/jquery.dataTables.min.js}"></script>
<script
	src="../../../resources/plugins/datatables/dataTables.bootstrap.min.js"
	th:src="@{/resources/plugins/datatables/dataTables.bootstrap.min.js}"></script>
<!-- iCheck -->
<script src="../../../resources/plugins/iCheck/icheck.min.js"
	th:src="@{/resources/plugins/iCheck/icheck.min.js}"></script>
<!-- jQuery impromptu -->
<script src="../../../resources/js/jquery-impromptu.min.js"
	th:src="@{/resources/js/jquery-impromptu.min.js}"></script>
<!-- Multiselect -->
<script src="../../../resources/plugins/multiselect/multiselect.min.js"
	th:src="@{/resources/plugins/multiselect/multiselect.min.js}"></script>
<!-- Multiselect -->
<script src="../../../resources/plugins/typeahead/typeahead.js"
	th:src="@{/resources/plugins/typeahead/typeahead.js}"></script>
<!-- Notification  -->
<script src="../../../resources/plugins/notification/jquery_notification_v.1.js"
	th:src="@{/resources/plugins/notification/jquery_notification_v.1.js}"></script>
<!-- Cookie -->
<script src="../../../resources/js/jquery.cookie.js"
	th:src="@{/resources/js/jquery.cookie.js}"></script>

	<script src="js/bootstrap-accessibility.min.js" type="text/javascript"></script>

<!-- Session Timeout -->
<script
	src="../../../resources/plugins/sessionTimeout/jquery.sessionTimeout.js"
	th:src="@{/resources/plugins/sessionTimeout/jquery.sessionTimeout.js}"></script>

<script>
		(function( $ ){
		jQuery.sessionTimeout = function( options ) {
			// DEFINE AN ARRAY TO STORE OTEHR MODALS TO CLOSE
			var otherModals = [];
			// DEFAULT CONFIG
			var defaults = {
				title		 	 : 'Your session is about to expire!',
				message          : 'Your session is about to expire.',
				titleMessage     : 'PMS',
	            stayConnectedBtn : 'Stay connected',
	            logoutBtn        : 'Logout',
	            closeModals		 : otherModals,
				keepAliveUrl     : '/pms/ajax/session',
				redirUrl         : '/pms/login?logout',
				logoutUrl        : '/pms/login?logout',
				warnAfter        : 1620000, // 27 minutes
				redirAfter       : 1800000 // 30 minutes
			};

			// Extend user-set options over defaults
				var o = defaults,
					dialogTimer,
					redirTimer;

			if ( options ) { o = $.extend( defaults, options ); }

			// Create timeout warning dialog

			//.html($('body').html()+
			$("#dailog").append('<div class="modal fade" id="sessionTimeout-dialog">'
								+'<div class="modal-dialog modal-relogin" style="width:40%">'
								+'<form action="#" id="relogin" name="relogin" method="post" th:action="@{/authenticate}">'
								+'<div class="modal-content">'
								+'<div class="modal-header">'
								+'<h4 class="modal-title text-center"><div id="timerDiv">Your session is about to expire in <span id="timerDiv2"></span>Min.<span id="timerDiv1" ></span> Sec. Please Relogin</div></h4>'
								+'</div>'
								+'<div class="modal-body"><div class="form-group"><label>User Name</label><input type="text" id="username" name="username" class="form-control" readonly="true" th:value="${#authentication.name}"/></div><div class="form-group"><label>Password</label><input type="password" id="password" name="password" class="form-control" th:value="${#authentication.name}" /></div></div>'
								+'<div class="modal-footer">'
								+'<div class="form-inline">'
								+'<div class="form-group"><button id="sessionTimeout-dialog-logout" type="button" class="btn btn-danger">'+o.logoutBtn+'</button>'
								+'<button id="sessionTimeout-dialog-keepalive" type="submit" class="btn btn-success" data-dismiss="modal" >'+o.stayConnectedBtn+'</button></div>'
								+'</div>'
								+'</div>'
								+'</div>'
								+'</form>'
								+'</div>'
								+'</div>');
			$('#sessionTimeout-dialog-logout').on('click', function () { window.location = o.logoutUrl;
			controlRedirTimer('stop'); });

			$("#sessionTimeout-dialog-keepalive").click(function(event) {

				formSubmission('relogin');
				controlRedirTimer('stop');
				controlDialogTimer('start');

			});

			document.getElementById("timerDiv1").innerHTML=0;
			document.getElementById("timerDiv2").innerHTML=3;

			/* t1=setInterval(function(){
				callTimer()
			},1000);
		 */


			function callTimer(){

				document.getElementById("timerDiv1").innerHTML=eval(document.getElementById("timerDiv1").innerHTML)-1;
				if(document.getElementById("timerDiv1").innerHTML==-1){
				document.getElementById("timerDiv1").innerHTML=59;
				document.getElementById("timerDiv2").innerHTML=eval(document.getElementById("timerDiv2").innerHTML)-1;
				}

				if(document.getElementById("timerDiv1").innerHTML==0)
				{
					if(document.getElementById("timerDiv2").innerHTML==0)
						{
					clearInterval(t1);
					controlRedirTimer('stop');
					window.location = o.redirUrl;
						}
					}

		}




			 $('#sessionTimeout-dialog').on('hide.bs.modal', function () {

				// Stop redirect timer and restart warning timer
				controlRedirTimer('stop');
				controlDialogTimer('start');
			});

			function controlDialogTimer(action){
				switch(action) {
					case 'start':
						// After warning period, show dialog and start redirect timer
						dialogTimer = setTimeout(function(){
							// CLOSE ANY POTENTIALLY OPEN MODALS
							t1=setInterval(function(){
								callTimer()
							},1000);
							document.getElementById("timerDiv1").innerHTML=0;
							document.getElementById("timerDiv2").innerHTML=3;
							$.each( o.closeModals, function( i, val ) {
								$('#' + val).modal('hide');
							});

							callTimer();

							$('#sessionTimeout-dialog').modal('show');

							controlRedirTimer('start');
						}, o.warnAfter);
						break;

					case 'stop':
						clearTimeout(dialogTimer);
						break;
				}
			}

			function controlRedirTimer(action){
				switch(action) {
					case 'start':
						// Dialog has been shown, if no action taken during redir period, redirect
						redirTimer = setTimeout(function(){
							window.location = o.redirUrl;
						}, o.redirAfter - o.warnAfter);
						break;

					case 'stop':
						clearTimeout(redirTimer);
						break;
				}
			}



			function formSubmission(formname)
			{

				$form=$(formname);
				var valll=$form.serialize();

			 	formElements=document.forms[formname].elements;
			 	var uname;
			 	var pwd;
				 for ( var i=formElements.length-1; i>=0; --i ){
			 		if(formElements[i].name=="username")
						{uname=formElements[i].value}
			 		if(formElements[i].name=="password")
			 		{pwd=formElements[i].value}
			 	}

				 var data = {username: uname,
							password : pwd};


	            $.ajax({
	                url: o.keepAliveUrl,
	                type: 'POST',
	                data: data,
	                success: function(result) {
	                    // ... Process the result ...
	                    console.log("success");
	                }
				});
			}



			// Begin warning period
			setTimeout(function(){
 		 /// call your function here
				controlDialogTimer('start');
			}, 1000);

	};

})(jQuery);






</script>
<!-- Custom JS -->
<script src="../../../resources/js/custom.js"
	th:src="@{/resources/js/custom.js}"></script>



</head>
<body class="skin-purple-light sidebar-mini">
	<div th:replace="fragments/header :: header">&nbsp;</div>
	<div th:replace="fragments/sidebarmenus :: sidebarmenus" id="headed">&nbsp;</div>
	<div id="dailog"></div>
	<div class="content-wrapper">
		<!-- /* Handle the flash message */-->
		<th:block th:if="${message != null}">
			<!-- /* The message code is returned from the @Controller */ -->
			<div
				th:replace="fragments/alert :: alert (type=${#strings.toLowerCase(message.type)}, message=#{${message.message}(${#authentication.name})})">&nbsp;</div>
		</th:block>
		<!-- Content Header starts -->
		<!--   <section class="content-header">
          <h1>Human Resource<small>Optional description</small></h1>
           <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-home"></i> Home</a></li>
            <li class="active">Here</li>
          </ol>
        </section> -->
		<!-- Content Header ends -->

		<!-- Main Content starts -->
		<div layout:fragment="content">
			<section class="content">
				<div class="box">
					<div class="box-body with-border">
						<p>Welcome to Performancess Management System!</p>
					</div>
				</div>
			</section>
		</div>



		<!-- Main Content ends -->
		<!-- <div th:replace="${view} :: content"> -->
		<!-- </div> -->
	</div>
	<div th:replace="fragments/footer :: footer">&copy; 2015 Arrk
		Group</div>
</body>
</html>